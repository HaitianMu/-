<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.prj.company.mapper.CompanybaseinfoMapper">
<!-- get area/industry list-->
    <select id="getAreaList" resultType="java.lang.String">
        select distinct area
        from companybaseinfo
    </select>
    <select id="getIndustryList" resultType="java.lang.String">
        select distinct industryClassification
        from companybaseinfo
    </select>

<!-- industry general-->
    <select id="industry_companyNumber" resultType="int" parameterType="java.lang.String">
        select count(*)
        from companybaseinfo
        where industryClassification = #{industry}
    </select>
    <select id="industry_areaCompany" resultType="com.example.prj.tools.areaData" parameterType="java.lang.String">
        select area as name, count(*) as value
        from companybaseinfo
        where industryClassification = #{industry}
        group by area
    </select>
    <select id="industry_totalAssets" resultType="double" parameterType="java.lang.String">
        select sum(totalAssets)
        from companybaseinfo
        where industryClassification = #{industry}
    </select>
    <select id="industry_areaAssets" resultType="com.example.prj.tools.areaData" parameterType="java.lang.String">
        select area as name, sum(totalAssets) as value
        from companybaseinfo
        where industryClassification = #{industry}
        group by area
    </select>
    <select id="industry_totalBusinessIncome" resultType="double" parameterType="java.lang.String">
        select sum(businessIncome)
        from companybaseinfo
        where industryClassification = #{industry}
    </select>
    <select id="industry_areaBusinessIncome" resultType="com.example.prj.tools.areaData" parameterType="java.lang.String">
        select area as name, sum(businessIncome) as value
        from companybaseinfo
        where industryClassification = #{industry}
        group by area
    </select>
    <select id="industry_totalDebt" resultType="double" parameterType="java.lang.String">
        select sum(totalDebt)
        from companybaseinfo
        where industryClassification = #{industry}
    </select>
    <select id="industry_areaDebt" resultType="com.example.prj.tools.areaData" parameterType="java.lang.String">
        select area as name, sum(totalDebt) as value
        from companybaseinfo
        where industryClassification = #{industry}
        group by area
    </select>
    <select id="industry_areaPureProfit" resultType="com.example.prj.tools.areaData" parameterType="java.lang.String">
        select area as name , sum(pureProfit) as value
        from companybaseinfo
        where industryClassification = #{industry}
        group by area
    </select>


<!-- area general -->
    <select id="area_companyNumber" resultType="int" parameterType="java.lang.String">
        select count(*)
        from companybaseinfo
        where area = #{area}
    </select>
    <select id="area_industryCompany" resultType="com.example.prj.tools.industryData" parameterType="java.lang.String">
        select industryClassification as name, count(*) as value
        from companybaseinfo
        where area = #{area}
        group by industryClassification
        order by count(*) DESC
    </select>
    <select id="area_totalAssets" resultType="double" parameterType="java.lang.String">
        select sum(totalAssets)
        from companybaseinfo
        where area = #{area}
    </select>
    <select id="area_industryAssets" resultType="com.example.prj.tools.industryData" parameterType="java.lang.String">
        select industryClassification as name, sum(totalAssets) as value
        from companybaseinfo
        where area = #{area}
        group by industryClassification
    </select>
    <select id="area_totalBusinessIncome" resultType="double" parameterType="java.lang.String">
        select sum(businessIncome)
        from companybaseinfo
        where area = #{area}
    </select>
    <select id="area_industryBusinessIncome" resultType="com.example.prj.tools.industryData" parameterType="java.lang.String">
        select industryClassification as name, sum(businessIncome) as value
        from companybaseinfo
        where area = #{area}
        group by industryClassification
    </select>
    <select id="area_totalDebt" resultType="double" parameterType="java.lang.String">
        select sum(totalDebt)
        from companybaseinfo
        where area = #{area}
    </select>
    <select id="area_industryDebt" resultType="com.example.prj.tools.industryData" parameterType="java.lang.String">
        select industryClassification as name, sum(totalDebt) as value
        from companybaseinfo
        where area = #{area}
        group by industryClassification
    </select>
    <select id="area_industryPureProfit" resultType="com.example.prj.tools.industryData" parameterType="java.lang.String">
        select industryClassification as name, sum(pureProfit) as value
        from companybaseinfo
        where area = #{area}
        group by industryClassification
        order by sum(pureProfit) DESC
    </select>

<!-- general data -->

    <select id="selectAreaCompany" resultType="com.example.prj.tools.areaData">
        select area as name, count(*) as value
        from companybaseinfo
        group by area
    </select>
    <select id="selectTotalCompany" resultType="int">
        select count(*)
        from companybaseinfo
    </select>
    <select id="selectIndustryCompany" resultType="com.example.prj.tools.industryData">
        select industryClassification as name, count(*) as value
        from companybaseinfo
        group by industryClassification
    </select>
    <select id="selectAreaBad" resultType="com.example.prj.tools.areaData">
        select area as name, count(*) as value
        from creditinfo
        group by area
    </select>
    <select id="selectTotalBad" resultType="int">
        select count(*)
        from creditinfo
    </select>
    <select id="selectAreaAssets" resultType="com.example.prj.tools.areaData">
        select area as name, sum(totalAssets) as value
        from companybaseinfo
        group by area
    </select>
    <select id="selectIndustryAssets" resultType="com.example.prj.tools.industryData">
        select industryClassification as name, sum(totalAssets) as value
        from companybaseinfo
        group by industryClassification
    </select>
    <select id="selectTotalAssets" resultType="double">
        select sum(totalAssets)
        from companybaseinfo
    </select>
    <select id="selectAreaPureAssets" resultType="com.example.prj.tools.areaData">
        select area as name, sum(pureAssets) as value
        from companybaseinfo
        group by area
    </select>
    <select id="selectIndustryPureAssets" resultType="com.example.prj.tools.industryData">
        select industryClassification as name, sum(pureAssets) as value
        from companybaseinfo
        group by industryClassification
    </select>
    <select id="selectTotalPureAssets" resultType="double">
        select sum(pureAssets)
        from companybaseinfo
    </select>
    <select id="selectAreaPureProfit" resultType="com.example.prj.tools.areaData">
        select area as name, sum(pureProfit) as value
        from companybaseinfo
        group by area
    </select>
    <select id="selectIndustryPureProfit" resultType="com.example.prj.tools.industryData">
        select industryClassification as name, sum(pureProfit) as value
        from companybaseinfo
        group by industryClassification
    </select>
    <select id="selectTotalPureProfit" resultType="double">
        select sum(pureProfit)
        from companybaseinfo
    </select>
    <select id="selectAreaDebt" resultType="com.example.prj.tools.areaData">
        select area as name, sum(totalDebt) as value
        from companybaseinfo
        group by area
    </select>
    <select id="selectIndustryDebt" resultType="com.example.prj.tools.industryData">
        select industryClassification as name, sum(totalDebt) as value
        from companybaseinfo
        group by industryClassification
    </select>
    <select id="selectTotalDebt" resultType="double">
        select sum(totalDebt)
        from companybaseinfo
    </select>
</mapper>
